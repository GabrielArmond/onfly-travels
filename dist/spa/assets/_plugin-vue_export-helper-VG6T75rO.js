import{a as c,z as j,b as X,g as N,c as $,r as f,i as F,o as V,h as s,w as A,T as Y}from"./index-DTg-vuUE.js";import{i as y,h as U,Q as G,l as E,m as J}from"./dom-BsBFrNZF.js";const K={ratio:[String,Number]};function Z(e,t){return c(()=>{const i=Number(e.ratio||(t!==void 0?t.value:void 0));return isNaN(i)!==!0&&i>0?{paddingBottom:`${100/i}%`}:null})}function z(){let e=null;const t=N();function i(){e!==null&&(clearTimeout(e),e=null)}return j(i),X(i),{removeTimeout:i,registerTimeout(o,l){i(),y(t)===!1&&(e=setTimeout(()=>{e=null,o()},l))}}}const p=1.7778,oe=$({name:"QImg",props:{...K,src:String,srcset:String,sizes:String,alt:String,crossorigin:String,decoding:String,referrerpolicy:String,draggable:Boolean,loading:{type:String,default:"lazy"},loadingShowDelay:{type:[Number,String],default:0},fetchpriority:{type:String,default:"auto"},width:String,height:String,initialRatio:{type:[Number,String],default:p},placeholderSrc:String,errorSrc:String,fit:{type:String,default:"cover"},position:{type:String,default:"50% 50%"},imgClass:String,imgStyle:Object,noSpinner:Boolean,noNativeMenu:Boolean,noTransition:Boolean,spinnerColor:String,spinnerSize:String},emits:["load","error"],setup(e,{slots:t,emit:i}){const o=f(e.initialRatio),l=Z(e,o),d=N(),{registerTimeout:m,removeTimeout:g}=z(),{registerTimeout:x,removeTimeout:L}=z(),b=c(()=>e.placeholderSrc!==void 0?{src:e.placeholderSrc}:null),H=c(()=>e.errorSrc!==void 0?{src:e.errorSrc,__qerror:!0}:null),r=[f(null),f(b.value)],a=f(0),v=f(!1),h=f(!1),I=c(()=>`q-img q-img--${e.noNativeMenu===!0?"no-":""}menu`),O=c(()=>({width:e.width,height:e.height})),P=c(()=>`q-img__image ${e.imgClass!==void 0?e.imgClass+" ":""}q-img__image--with${e.noTransition===!0?"out":""}-transition q-img__image--`),R=c(()=>({...e.imgStyle,objectFit:e.fit,objectPosition:e.position}));function W(){if(L(),e.loadingShowDelay===0){v.value=!0;return}x(()=>{v.value=!0},e.loadingShowDelay)}function T(){L(),v.value=!1}function B({target:n}){y(d)===!1&&(g(),o.value=n.naturalHeight===0?.5:n.naturalWidth/n.naturalHeight,C(n,1))}function C(n,u){u===1e3||y(d)===!0||(n.complete===!0?D(n):m(()=>{C(n,u+1)},50))}function D(n){y(d)!==!0&&(a.value=a.value^1,r[a.value].value=null,T(),n.getAttribute("__qerror")!=="true"&&(h.value=!1),i("load",n.currentSrc||n.src))}function M(n){g(),T(),h.value=!0,r[a.value].value=H.value,r[a.value^1].value=b.value,i("error",n)}function q(n){const u=r[n].value,w={key:"img_"+n,class:P.value,style:R.value,alt:e.alt,crossorigin:e.crossorigin,decoding:e.decoding,referrerpolicy:e.referrerpolicy,height:e.height,width:e.width,loading:e.loading,fetchpriority:e.fetchpriority,"aria-hidden":"true",draggable:e.draggable,...u};return a.value===n?Object.assign(w,{class:w.class+"current",onLoad:B,onError:M}):w.class+="loaded",s("div",{class:"q-img__container absolute-full",key:"img"+n},s("img",w))}function Q(){return v.value===!1?s("div",{key:"content",class:"q-img__content absolute-full q-anchor--skip"},U(t[h.value===!0?"error":"default"])):s("div",{key:"loading",class:"q-img__loading absolute-full flex flex-center"},t.loading!==void 0?t.loading():e.noSpinner===!0?void 0:[s(G,{color:e.spinnerColor,size:e.spinnerSize})])}{let n=function(){A(()=>e.src||e.srcset||e.sizes?{src:e.src,srcset:e.srcset,sizes:e.sizes}:null,u=>{g(),h.value=!1,u===null?(T(),r[a.value^1].value=b.value):W(),r[a.value].value=u},{immediate:!0})};F.value===!0?V(n):n()}return()=>{const n=[];return l.value!==null&&n.push(s("div",{key:"filler",style:l.value})),r[0].value!==null&&n.push(q(0)),r[1].value!==null&&n.push(q(1)),n.push(s(Y,{name:"q-transition--fade"},Q)),s("div",{key:"main",class:I.value,style:O.value,role:"img","aria-label":e.alt},n)}}}),le=[Element,String],ee=[null,document,document.body,document.scrollingElement,document.documentElement];function re(e,t){let i=J(t);if(i===void 0){if(e==null)return window;i=e.closest(".scroll,.scroll-y,.overflow-auto")}return ee.includes(i)?window:i}function ae(e){return(e===window?document.body:e).scrollHeight}function te(e){return e===window?window.pageYOffset||window.scrollY||document.body.scrollTop||0:e.scrollTop}function se(e){return e===window?window.pageXOffset||window.scrollX||document.body.scrollLeft||0:e.scrollLeft}function k(e,t,i=0){const o=arguments[3]===void 0?performance.now():arguments[3],l=te(e);if(i<=0){l!==t&&_(e,t);return}requestAnimationFrame(d=>{const m=d-o,g=l+(t-l)/Math.max(m,i)*m;_(e,g),g!==t&&k(e,t,i-m,d)})}function _(e,t){if(e===window){window.scrollTo(window.pageXOffset||window.scrollX||document.body.scrollLeft||0,t);return}e.scrollTop=t}function ue(e,t,i){if(i){k(e,t,i);return}_(e,t)}let S;function ce(){if(S!==void 0)return S;const e=document.createElement("p"),t=document.createElement("div");E(e,{width:"100%",height:"200px"}),E(t,{position:"absolute",top:"0px",left:"0px",visibility:"hidden",width:"200px",height:"150px",overflow:"hidden"}),t.appendChild(e),document.body.appendChild(t);const i=e.offsetWidth;t.style.overflow="scroll";let o=e.offsetWidth;return i===o&&(o=t.clientWidth),t.remove(),S=i-o,S}function de(e,t=!0){return!e||e.nodeType!==Node.ELEMENT_NODE?!1:t?e.scrollHeight>e.clientHeight&&(e.classList.contains("scroll")||e.classList.contains("overflow-auto")||["auto","scroll"].includes(window.getComputedStyle(e)["overflow-y"])):e.scrollWidth>e.clientWidth&&(e.classList.contains("scroll")||e.classList.contains("overflow-auto")||["auto","scroll"].includes(window.getComputedStyle(e)["overflow-x"]))}const ge=(e,t)=>{const i=e.__vccOpts||e;for(const[o,l]of t)i[o]=l;return i};export{oe as Q,ge as _,te as a,se as b,ce as c,ae as d,ue as e,re as g,de as h,le as s,z as u};
